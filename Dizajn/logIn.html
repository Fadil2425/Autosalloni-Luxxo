<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxxo Cars - Log In</title>
    <link rel="icon" type="image/png" href="../img/car.png">
    <link rel="stylesheet" href="logInStyle.css">
</head>
<body>
    <form class="box" id="loginForm">
        <div class="text">
            <img src="../img/car.png" alt="">
            
            <input type="email" id="logEmail" name="email" placeholder="Email"> <br>
            <input type="password" id="logPass" name="password" placeholder="Password"> <br>
            
            <p id="mesazhi" style="color: red; font-size: 12px; font-weight: bold; min-height: 15px;"></p>

            <button type="submit" id="btnLog">Log In</button>

            <div class="fundi">
                <a class="a" href="index.html">Back</a>
                <a href="signUp.html" class="a">Sign Up</a>
            </div>
        </div>
    </form>
    <script>
        document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault(); 

            const email = document.getElementById('logEmail').value.trim();
            const pass = document.getElementById('logPass').value;
            const msg = document.getElementById('mesazhi');

            if (email === "" || pass === "") {
                msg.innerText = "Plotesoni te gjitha fushat!";
                return;
            }

            const perdoruesiRuajtur = localStorage.getItem(email);

            if (!perdoruesiRuajtur) {
                msg.innerText = "Ky email nuk ekziston ne sistem!";
            }
            else {
                const user = JSON.parse(perdoruesiRuajtur);

                if (user.password === pass) {
                    msg.style.color = "lightgreen";
                    msg.innerText = "Mireseerdhe! Po ju drejtojme...";

                    localStorage.setItem("userKycur", JSON.stringify(user));

                    setTimeout(() => {
                        if (user.roli === "admin") {
                            window.location.href = "admin.html";
                        } else {
                            window.location.href = "Ballina.html";
                        }
                    }, 1200);
                } else {
                    msg.innerText = "Fjalekalimi i gabuar!";
                }
            }
        });
    </script>
</body>
</html>